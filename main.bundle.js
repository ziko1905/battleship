(()=>{var e={288:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(601),r=n.n(i),s=n(314),o=n.n(s)()(r());o.push([e.id,"/*! modern-normalize v3.0.1 | MIT License | https://github.com/sindresorhus/modern-normalize */\n\n/*\nDocument\n========\n*/\n\n/**\nUse a better box model (opinionated).\n*/\n\n*,\n::before,\n::after {\n\tbox-sizing: border-box;\n}\n\nhtml {\n\t/* Improve consistency of default fonts in all browsers. (https://github.com/sindresorhus/modern-normalize/issues/3) */\n\tfont-family:\n\t\tsystem-ui,\n\t\t'Segoe UI',\n\t\tRoboto,\n\t\tHelvetica,\n\t\tArial,\n\t\tsans-serif,\n\t\t'Apple Color Emoji',\n\t\t'Segoe UI Emoji';\n\tline-height: 1.15; /* 1. Correct the line height in all browsers. */\n\t-webkit-text-size-adjust: 100%; /* 2. Prevent adjustments of font size after orientation changes in iOS. */\n\ttab-size: 4; /* 3. Use a more readable tab size (opinionated). */\n}\n\n/*\nSections\n========\n*/\n\nbody {\n\tmargin: 0; /* Remove the margin in all browsers. */\n}\n\n/*\nText-level semantics\n====================\n*/\n\n/**\nAdd the correct font weight in Chrome and Safari.\n*/\n\nb,\nstrong {\n\tfont-weight: bolder;\n}\n\n/**\n1. Improve consistency of default fonts in all browsers. (https://github.com/sindresorhus/modern-normalize/issues/3)\n2. Correct the odd 'em' font sizing in all browsers.\n*/\n\ncode,\nkbd,\nsamp,\npre {\n\tfont-family:\n\t\tui-monospace,\n\t\tSFMono-Regular,\n\t\tConsolas,\n\t\t'Liberation Mono',\n\t\tMenlo,\n\t\tmonospace; /* 1 */\n\tfont-size: 1em; /* 2 */\n}\n\n/**\nAdd the correct font size in all browsers.\n*/\n\nsmall {\n\tfont-size: 80%;\n}\n\n/**\nPrevent 'sub' and 'sup' elements from affecting the line height in all browsers.\n*/\n\nsub,\nsup {\n\tfont-size: 75%;\n\tline-height: 0;\n\tposition: relative;\n\tvertical-align: baseline;\n}\n\nsub {\n\tbottom: -0.25em;\n}\n\nsup {\n\ttop: -0.5em;\n}\n\n/*\nTabular data\n============\n*/\n\n/**\nCorrect table border color inheritance in Chrome and Safari. (https://issues.chromium.org/issues/40615503, https://bugs.webkit.org/show_bug.cgi?id=195016)\n*/\n\ntable {\n\tborder-color: currentcolor;\n}\n\n/*\nForms\n=====\n*/\n\n/**\n1. Change the font styles in all browsers.\n2. Remove the margin in Firefox and Safari.\n*/\n\nbutton,\ninput,\noptgroup,\nselect,\ntextarea {\n\tfont-family: inherit; /* 1 */\n\tfont-size: 100%; /* 1 */\n\tline-height: 1.15; /* 1 */\n\tmargin: 0; /* 2 */\n}\n\n/**\nCorrect the inability to style clickable types in iOS and Safari.\n*/\n\nbutton,\n[type='button'],\n[type='reset'],\n[type='submit'] {\n\t-webkit-appearance: button;\n}\n\n/**\nRemove the padding so developers are not caught out when they zero out 'fieldset' elements in all browsers.\n*/\n\nlegend {\n\tpadding: 0;\n}\n\n/**\nAdd the correct vertical alignment in Chrome and Firefox.\n*/\n\nprogress {\n\tvertical-align: baseline;\n}\n\n/**\nCorrect the cursor style of increment and decrement buttons in Safari.\n*/\n\n::-webkit-inner-spin-button,\n::-webkit-outer-spin-button {\n\theight: auto;\n}\n\n/**\n1. Correct the odd appearance in Chrome and Safari.\n2. Correct the outline style in Safari.\n*/\n\n[type='search'] {\n\t-webkit-appearance: textfield; /* 1 */\n\toutline-offset: -2px; /* 2 */\n}\n\n/**\nRemove the inner padding in Chrome and Safari on macOS.\n*/\n\n::-webkit-search-decoration {\n\t-webkit-appearance: none;\n}\n\n/**\n1. Correct the inability to style clickable types in iOS and Safari.\n2. Change font properties to 'inherit' in Safari.\n*/\n\n::-webkit-file-upload-button {\n\t-webkit-appearance: button; /* 1 */\n\tfont: inherit; /* 2 */\n}\n\n/*\nInteractive\n===========\n*/\n\n/*\nAdd the correct display in Chrome and Safari.\n*/\n\nsummary {\n\tdisplay: list-item;\n}\n",""]);const a=o},365:(e,t,n)=>{"use strict";n.d(t,{A:()=>g});var i=n(601),r=n.n(i),s=n(314),o=n.n(s),a=n(288),c=n(417),l=n.n(c),d=new URL(n(644),n.b),h=new URL(n(922),n.b),p=o()(r());p.i(a.A);var u=l()(d),m=l()(h);p.push([e.id,`@font-face {\n  font-family: "soda_shakeregular";\n  src:\n    url(${u}) format("woff2"),\n    url(${m}) format("woff");\n  font-weight: normal;\n  font-style: normal;\n}\n\n:root {\n  font-family: "soda_shakeregular", "Courier New", Courier, monospace;\n  --first-ply-clr: rgb(86, 202, 255);\n  --second-ply-clr: rgb(255, 77, 77);\n}\n\n.content {\n  display: flex;\n  justify-content: center;\n  gap: 5vw;\n}\n\n.playing-div {\n  display: grid;\n  grid-template-columns: auto auto;\n  grid-template-rows: 100px auto;\n  justify-items: center;\n  align-items: center;\n  gap: 0 20px;\n\n  margin-top: 10vh;\n}\n\n.ship-container {\n  padding: 20px;\n  background-color: #f3f3f3;\n  width: 15vw;\n  height: max(45vh, 100%);\n  border-radius: 20px;\n  box-shadow: 0 0 6px -3px;\n}\n\np {\n  font-size: 2rem;\n}\n\n.playing-div p.turn {\n  font-size: 3rem;\n  text-decoration: underline;\n}\n\n#left-playing-div p {\n  grid-column: 2;\n  grid-row: 1;\n}\n\n#left-playing-div .main-grid-div {\n  grid-column: 2;\n  grid-row: 2;\n}\n\n#left-playing-div .ship-container {\n  grid-row: 2;\n  grid-column: 1;\n}\n\n#right-playing-div .main-grid-div {\n  grid-column: 1;\n  grid-row: 2;\n}\n\n#right-playing-div .ship-container {\n  grid-row: 2;\n  grid-column: 2;\n}\n\n.main-grid-div {\n  display: inline-grid;\n  grid-template-columns: repeat(10, 1fr);\n  grid-template-rows: repeat(10, 1fr);\n  gap: 1px;\n\n  position: relative;\n  width: 25vw;\n  height: 25vw;\n  align-self: start;\n}\n\n#left-playing-div .main-grid-div::before {\n  position: absolute;\n  content: "For rotating ships click them.";\n  transform: translate(0, -100%);\n}\n\n.cell {\n  background-color: rgb(235, 235, 235);\n}\n\n#left-playing-div .cell.ship {\n  background-color: var(--first-ply-clr);\n}\n\n#right-playing-div .cell.ship {\n  background-color: var(--second-ply-clr);\n}\n\n.cell img {\n  width: 100%;\n}\n\n.cell.ship img {\n  filter: brightness(0) saturate(100%) invert(22%) sepia(45%) saturate(2438%)\n    hue-rotate(339deg) brightness(72%) contrast(106%);\n}\n\n.error-div {\n  position: fixed;\n  display: inline-block;\n  background-color: #ff7171;\n  color: #000000;\n  padding: 10px 20px;\n  top: 30px;\n  left: 50%;\n  transform: translate(-50%, 0);\n  box-sizing: border-box;\n  border-radius: 20px;\n  box-shadow: 0 0 13px -4px;\n}\n\n.win-div {\n  position: fixed;\n  padding: 20px;\n  width: 50vw;\n  background-color: rgb(149, 255, 149);\n  text-align: center;\n  bottom: 50%;\n  left: 50%;\n  transform: translate(-50%, 0);\n  border-radius: 30px;\n}\n\n.win-p {\n  font-size: 3rem;\n}\n\n.win-btn {\n  font-size: 2rem;\n  padding: 10px;\n  border-radius: 10px;\n}\n\n.ship-container {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  gap: 10px;\n}\n\n.display-ship {\n  display: flex;\n  gap: 1px;\n}\n\n.display-ship.vertical {\n  flex-direction: column;\n}\n\n.display-ship.on-grid {\n  position: absolute;\n}\n\n.display-ship.transparent {\n  pointer-events: none;\n}\n\n#left-playing-div .display-ship div {\n  background-color: var(--first-ply-clr);\n}\n\n#right-playing-div .display-ship div {\n  background-color: var(--second-ply-clr);\n}\n\n.fnct-btn-div {\n  grid-row: 2;\n  grid-column: 1;\n  align-self: start;\n  display: flex;\n  gap: 20px;\n}\n\n.fnct-btn {\n  background-color: var(--first-ply-clr);\n  font-size: 1.2rem;\n  padding: 5px;\n  border-radius: 10px;\n  border: none;\n  border-bottom: 4px solid rgb(46, 112, 143);\n}\n\n.fnct-btn:active {\n  background-color: rgb(46, 112, 143);\n}\n\n.play-btn {\n  font-size: 3rem;\n  position: fixed;\n  bottom: 100px;\n  border: none;\n  background-color: #a4ffa4;\n  border-radius: 20px;\n  padding: 10px 50px;\n  left: 50%;\n  transform: translate(-50%, 0);\n  border-bottom: 5px solid #77c577;\n}\n\n.play-btn:active {\n  background-color: #77c577;\n}\n`,""]);const g=p},314:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",i=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),i&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),i&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,i,r,s){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(i)for(var a=0;a<this.length;a++){var c=this[a][0];null!=c&&(o[c]=!0)}for(var l=0;l<e.length;l++){var d=[].concat(e[l]);i&&o[d[0]]||(void 0!==s&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=s),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),r&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=r):d[4]="".concat(r)),t.push(d))}},t}},417:e=>{"use strict";e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},601:e=>{"use strict";e.exports=function(e){return e[1]}},224:function(e,t,n){e=n.nmd(e),function(n){"use strict";var i={};n.PubSub?(i=n.PubSub,console.warn("PubSub already loaded, using existing version")):(n.PubSub=i,function(e){var t={},n=-1,i="*";function r(e,t,n){try{e(t,n)}catch(e){setTimeout(function(e){return function(){throw e}}(e),0)}}function s(e,t,n){e(t,n)}function o(e,n,i,o){var a,c=t[n],l=o?s:r;if(Object.prototype.hasOwnProperty.call(t,n))for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&l(c[a],e,i)}function a(e){var n=String(e);return Boolean(Object.prototype.hasOwnProperty.call(t,n)&&function(e){var t;for(t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!0;return!1}(t[n]))}function c(e,t,n,r){var s=function(e,t,n){return function(){var r=String(e),s=r.lastIndexOf(".");for(o(e,e,t,n);-1!==s;)s=(r=r.substr(0,s)).lastIndexOf("."),o(e,r,t,n);o(e,i,t,n)}}(e="symbol"==typeof e?e.toString():e,t,r);return!!function(e){for(var t=String(e),n=a(t)||a(i),r=t.lastIndexOf(".");!n&&-1!==r;)r=(t=t.substr(0,r)).lastIndexOf("."),n=a(t);return n}(e)&&(!0===n?s():setTimeout(s,0),!0)}e.publish=function(t,n){return c(t,n,!1,e.immediateExceptions)},e.publishSync=function(t,n){return c(t,n,!0,e.immediateExceptions)},e.subscribe=function(e,i){if("function"!=typeof i)return!1;e="symbol"==typeof e?e.toString():e,Object.prototype.hasOwnProperty.call(t,e)||(t[e]={});var r="uid_"+String(++n);return t[e][r]=i,r},e.subscribeAll=function(t){return e.subscribe(i,t)},e.subscribeOnce=function(t,n){var i=e.subscribe(t,(function(){e.unsubscribe(i),n.apply(this,arguments)}));return e},e.clearAllSubscriptions=function(){t={}},e.clearSubscriptions=function(e){var n;for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&0===n.indexOf(e)&&delete t[n]},e.countSubscriptions=function(e){var n,i,r=0;for(n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&0===n.indexOf(e)){for(i in t[n])r++;break}return r},e.getSubscriptions=function(e){var n,i=[];for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&0===n.indexOf(e)&&i.push(n);return i},e.unsubscribe=function(n){var i,r,s,o="string"==typeof n&&(Object.prototype.hasOwnProperty.call(t,n)||function(e){var n;for(n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&0===n.indexOf(e))return!0;return!1}(n)),a=!o&&"string"==typeof n,c="function"==typeof n,l=!1;if(!o){for(i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(r=t[i],a&&r[n]){delete r[n],l=n;break}if(c)for(s in r)Object.prototype.hasOwnProperty.call(r,s)&&r[s]===n&&(delete r[s],l=!0)}return l}e.clearSubscriptions(n)}}(i)),void 0!==e&&e.exports&&(t=e.exports=i),t.PubSub=i,e.exports=t=i}("object"==typeof window&&window||this)},72:e=>{"use strict";var t=[];function n(e){for(var n=-1,i=0;i<t.length;i++)if(t[i].identifier===e){n=i;break}return n}function i(e,i){for(var s={},o=[],a=0;a<e.length;a++){var c=e[a],l=i.base?c[0]+i.base:c[0],d=s[l]||0,h="".concat(l," ").concat(d);s[l]=d+1;var p=n(h),u={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==p)t[p].references++,t[p].updater(u);else{var m=r(u,i);i.byIndex=a,t.splice(a,0,{identifier:h,updater:m,references:1})}o.push(h)}return o}function r(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,r){var s=i(e=e||[],r=r||{});return function(e){e=e||[];for(var o=0;o<s.length;o++){var a=n(s[o]);t[a].references--}for(var c=i(e,r),l=0;l<s.length;l++){var d=n(s[l]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}s=c}}},659:e=>{"use strict";var t={};e.exports=function(e,n){var i=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},540:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},56:(e,t,n)=>{"use strict";e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},825:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,r&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleTagTransform(i,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},113:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},922:(e,t,n)=>{"use strict";e.exports=n.p+"acec548fe91eb44dc612.woff"},644:(e,t,n)=>{"use strict";e.exports=n.p+"790f0fd94a4e55658ee0.woff2"}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var s=t[i]={id:i,loaded:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var i=t.getElementsByTagName("script");if(i.length)for(var r=i.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=i[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),n.b=document.baseURI||self.location.href,n.nc=void 0;var i={};(()=>{"use strict";n.d(i,{OQ:()=>F,P:()=>M,eq:()=>Z,cL:()=>U,zj:()=>G,wC:()=>_});var e=n(72),t=n.n(e),r=n(825),s=n.n(r),o=n(659),a=n.n(o),c=n(56),l=n.n(c),d=n(540),h=n.n(d),p=n(113),u=n.n(p),m=n(365),g={};g.styleTagTransform=u(),g.setAttributes=l(),g.insert=a().bind(null,"head"),g.domAPI=s(),g.insertStyleElement=h(),t()(m.A,g),m.A&&m.A.locals&&m.A.locals;var f=n(224),v=n.n(f);class b{static SIZE=10;constructor(){this.mainDiv=document.createElement("div"),this.mainDiv.className="main-grid-div",this.mainDiv.setAttribute("data-size",b.SIZE);for(let e=0;e<b.SIZE;e++)for(let t=0;t<b.SIZE;t++){const n=document.createElement("div");n.className="cell",n.setAttribute("data-row",e),n.setAttribute("data-col",t),this.mainDiv.appendChild(n)}}getElement(){return this.mainDiv}}class y{constructor(){this.container=document.createElement("div"),this.container.className="ship-container"}getElement(){return this.container}}!function(){const e=document.createElement("div"),t=document.createElement("div"),n=new b,i=new b,r=document.createElement("p"),s=document.createElement("p"),o=new y,a=new y;e.className="playing-div",e.id="left-playing-div",t.className="playing-div",t.id="right-playing-div",r.textContent="Player",r.classList.add("turn"),s.textContent="Computer",e.appendChild(n.getElement()),e.appendChild(r),e.appendChild(o.getElement()),t.appendChild(i.getElement()),t.appendChild(s),t.appendChild(a.getElement()),document.querySelector(".content").appendChild(e),document.querySelector(".content").appendChild(t)}();class w{constructor(e){const t=document.createElement("div"),n=document.createElement("p");t.className="error-div",n.className="error-p",n.textContent=e,t.appendChild(n),this.div=t}show(e){document.body.appendChild(this.div),e&&setTimeout((()=>this.remove()),e)}remove(){this.div.remove()}}class S{static winDiv=document.createElement("div");static create(e,t,n){const i=document.createElement("p"),r=document.createElement("button");S.winDiv.className="win-div",i.className="win-p",i.textContent=`${e} won! With ${t} boats left!`,r.className="win-btn",r.textContent="Play again",r.addEventListener("click",(()=>{S.remove(),n()})),S.winDiv.appendChild(i),S.winDiv.appendChild(r),document.body.appendChild(S.winDiv)}static remove(){S.winDiv.textContent="",document.body.removeChild(S.winDiv)}}class E{static buttonsDiv=document.createElement("div");static createRandom(){const e=document.createElement("button");e.textContent="random",e.className="fnct-btn",e.addEventListener("click",(()=>Z())),E.buttonsDiv.appendChild(e)}static createReset(){const e=document.createElement("button");e.textContent="reset",e.className="fnct-btn",e.addEventListener("click",(()=>U())),E.buttonsDiv.appendChild(e)}static create(){E.buttonsDiv.className="fnct-btn-div",document.querySelector("#left-playing-div").appendChild(E.buttonsDiv),E.createRandom(),E.createReset()}}class x{constructor(){this.btn=document.createElement("button"),this.btn.className="play-btn",this.btn.textContent="Play!",this.btn.addEventListener("click",(()=>{G()&&this.btn.remove()})),document.body.appendChild(this.btn)}}E.create();const C=n.p+"85a7d14e6ea4a9556026.svg";class k{static cellClickEvents=[];static cellDragEvents=[];static cellDropEvents=[];constructor(e){this.div=e}showShip(e,t,n,i=!1){for(let r=0;r<n;r++){let n;n=i?this.div.querySelector(`[data-row="${e+r}"][data-col="${t}"]`):this.div.querySelector(`[data-row="${e}"][data-col="${t+r}"]`),n.classList.add("ship")}}reviewEmpty(e,t){const n=this.div.querySelector(`[data-row="${e}"][data-col="${t}"]`),i=document.createElement("img");i.src=C,n.appendChild(i)}reviewShip(e,t){const n=this.div.querySelector(`[data-row="${e}"][data-col="${t}"]`),i=document.createElement("img");i.src=C,n.classList.add("ship"),n.appendChild(i)}static clearGrid(e){(e||document.body).querySelectorAll(".cell").forEach((e=>{e.textContent="",e.className="cell"}))}static displayTurn(){const e=document.querySelector("#left-playing-div p"),t=document.querySelector("#right-playing-div p");e.classList.toggle("turn"),t.classList.toggle("turn")}makeCellsAcceptDrag(){this.div.querySelectorAll(".cell").forEach((e=>{const t=e=>{const t=P.picked,n=+e.target.getAttribute("data-row"),i=+e.target.getAttribute("data-col");let r=n,s=i;t.vertical?(r=n-t.cellFrom>-1?n-t.cellFrom:0,r=r>10-t.length?10-t.length:r):(s=i-t.cellFrom>-1?i-t.cellFrom:0,s=s>10-t.length?10-t.length:s),this.div.querySelector(`[data-row="${r}"][data-col="${s}"]`).appendChild(t.getElement()),t.place(r,s)},n=e=>{try{M.logic.board.place(...P.picked.getPlacingValue())}catch(t){new w(t).show(1e3),P.picked.sendBack(e)}};k.cellDragEvents.push([e,t]),k.cellDropEvents.push([e,n]),e.addEventListener("dragover",(e=>e.preventDefault())),e.addEventListener("dragenter",t),e.addEventListener("drop",n)}))}static addListenersToCells(e=!0){let t=document;e&&(t=document.querySelector("#right-playing-div")),t.querySelectorAll(".cell").forEach((e=>{const t=()=>{(_.isPlaying()||(document.querySelector(".play-btn").click(),_.isPlaying()))&&F(+e.getAttribute("data-row"),+e.getAttribute("data-col"),document.getElementById("left-playing-div").contains(e))};k.cellClickEvents.push([e,t]),e.addEventListener("click",t)}))}static removeCellsListeners(){k.cellClickEvents.forEach((e=>e[0].removeEventListener("click",e[1]))),k.cellClickEvents=[]}static removeDragListeners(){k.cellDragEvents.forEach((e=>e[0].removeEventListener("dragenter",e[1]))),k.cellDropEvents.forEach((e=>e[0].removeEventListener("drop",e[1]))),k.cellDragEvents=[],k.cellDropEvents=[]}}class A{constructor(e,t,n=!1,i=!1){if(this.div=e,this.container=e.querySelector(".ship-container"),this.container.textContent="",this.computer=n,n)this.ships=t.ships,this.ships.sort(((e,t)=>t[2]-e[2])),this.ships.forEach((e=>{const t=this.createShip(e[2]);this.container.appendChild(t),v().subscribe(e[4].publish,(()=>{t.remove()}))}));else if(!i)for(let e of[5,4,3,3,2]){const t=new P(e);this.container.appendChild(t.getElement())}}createShip(e){const t=document.createElement("div"),n=getComputedStyle(this.div.querySelector(".cell")).height;for(let i=0;i<e;i++){const e=document.createElement("div");e.style.height=n,e.style.width=n,t.appendChild(e)}return t.className="display-ship",t}getElement(){return this.container}}class P{static picked;static shipId=0;constructor(e,t=!1){this.length=e,this.m=null,this.n=null,this.shipId=P.shipId,this.vertical=!1,P.shipId++,this.cellFrom=0,this.create()}create(){this.main=document.createElement("div"),this.main.className="display-ship",this.main.draggable=!0;const e=`dragship-${this.shipId}`;for(let t=0;t<this.length;t++){const n=new O(t,e);this.main.appendChild(n.getElement())}v().subscribe(e,((e,t)=>{this.cellFrom=t})),this.main.addEventListener("drag",(()=>{this.getElement().classList.add("transparent"),P.picked=this})),this.main.addEventListener("dragenter",(e=>e.stopPropagation())),this.main.addEventListener("click",(e=>this.rotate(e))),this.main.addEventListener("dragend",(e=>this.sendBack(e))),this.main.addEventListener("dragstart",(e=>this.clear()))}clear(e){null!==this.m&&null!==this.n&&M.logic.board.remove(...this.getPlacingValue())}rotate(e){try{this.clear(),this.vertical=!this.vertical,this.main.classList.toggle("vertical"),null!==this.m&&null!==this.n&&M.logic.board.place(...this.getPlacingValue())}catch(t){new w(t).show(1e3),this.sendBack(e,!0)}}sendBack(e,t=!1){this.getElement().classList.remove("transparent"),(t||"none"===e.dataTransfer.dropEffect)&&(this.getElement().classList.remove("on-grid"),document.querySelector("#left-playing-div .ship-container").appendChild(this.getElement()),this.resetCoords())}getElement(){return this.main}place(e,t){this.getElement().classList.add("on-grid"),this.m=e,this.n=t}resetCoords(){this.m=null,this.n=null}getPlacingValue(){return[this.m,this.n,this.length,this.vertical]}}class O{constructor(e,t){this.id=e,this.publish=t,this.create()}create(){this.main=document.createElement("div");const e=getComputedStyle(document.querySelector(".cell")).height;this.main.style.height=e,this.main.style.width=e,this.main.addEventListener("mousedown",(()=>{v().publish(this.publish,+this.id)}))}getElement(){return this.main}}const L=new k(document.querySelector("#left-playing-div .main-grid-div")),D=new k(document.querySelector("#right-playing-div .main-grid-div"));class I{constructor(e,t){this.length=e,this.hp=e,this.publish=t}hit(){if(!this.hp)throw new Error("Ship already sank");this.hp--,this.hp||v().publishSync(this.publish)}isSunk(){return!this.hp}}class N{static#e=0;static BOARD_SIZE=10;constructor(){this.aliveShips=0,this.ships=[];for(let e=0;e<N.BOARD_SIZE;e++){this[e]={};for(let t=0;t<N.BOARD_SIZE;t++)this[e][t]=new R}}place(e,t,n,i=!1){this.checkPlace(e,t),this.checkLength(e,t,n,i);let r=[];const s="board-channel-"+N.#e++,o=new I(n,s);this.token=v().subscribe(s,(()=>this.sinkAnother())),this.ships.push([...arguments,o]);try{if(i)for(let i=0;i<n;i++)this.checkPlace(e+i,t),this[e+i][t].makeShip(o),r.push(this[e+i][t]);else for(let i=0;i<n;i++)this.checkPlace(e,t+i),this[e][t+i].makeShip(o),r.push(this[e][t+i]);this.aliveShips++}catch(e){throw r.forEach((e=>e.unmakeShip())),this.ships.pop(),e}}isShip(e,t){return this[e][t].isShip()}checkPlace(e,t){if(e<0||e>N.BOARD_SIZE-1||t<0||t>N.BOARD_SIZE-1)throw new Error("Wrong ship coordinates");if(this[e][t].isShip())throw new Error("Cell already occupied")}checkLength(e,t,n,i){if(n<1||!i&&t+n-1>N.BOARD_SIZE-1)throw new Error("Ship too long");if(i&&e+n-1>N.BOARD_SIZE-1)throw new Error("Ship too long")}receiveAttack(e,t){if(this[e][t].isChecked())throw new Error("Cell already checked");return this[e][t].check(),this[e][t].isShip()&&this[e][t].ship.hit(),this.isShip(e,t)}areAllSunk(){return!this.aliveShips}sinkAnother(){this.aliveShips--}getAllShips(){return this.ships}remove(e,t,n,i=!1){for(let r=0;r<n;r++){let n=e,s=t;i?n=e+r:s=t+r,this[n][s]=new R}this.sinkAnother()}}class R{constructor(){this.checked=!1,this.ship=!1}makeShip(e){this.ship=e}unmakeShip(){this.ship=!1}isShip(){return!!this.ship}isChecked(){return this.checked}check(){this.checked=!0}}class q{constructor(){this.board=new N}placeShips(){let e=0;const t=[5,4,3,3,2];for(;e<t.length;)try{const n=this.getRandomCoords(),i=this.getRandomCoords();this.board.place(n,i,t[e],Math.floor(2*Math.random())),e++}catch{continue}}getRandomCoords(){return Math.floor(Math.random()*(N.BOARD_SIZE+1))}}class T extends q{constructor(){super(),this.placeShips(),this.createGuesses()}guessRandom(){return this.guesses.pop()}async createGuesses(){this.guesses=[];for(let e=0;e<N.BOARD_SIZE;e++)for(let t=0;t<N.BOARD_SIZE;t++)this.guesses.push([e,t]);!function(e){let t=e.length-1;for(;t>0;){const n=Math.floor(e.length*Math.random()),i=e[n],r=e[t];e[t]=i,e[n]=r,t--}}(this.guesses)}}const j="win";class z{constructor(e,t){this.left=e,this.right=t,this.next=e,this.play=!1}isLeftTurn(){return this.next===this.left}getNext(){return this.next}getNextAttacked(){return this.next==this.left?this.right:this.left}changeTurn(){k.displayTurn(),this.next===this.left?(this.next=this.right,async function(){for(;!_.isLeftTurn();){const e=_.getNext().logic.guessRandom();await new Promise((e=>setTimeout(e,1e3))),F(e[0],e[1],!0)}}()):this.next=this.left}isComputerPlaying(){return this.right.logic instanceof T}isPlaying(){return this.play}startPlaying(){this.play=!0,k.removeDragListeners()}}let M,$,_;function B(){k.clearGrid(),M={logic:new q,grid:L,name:"Player"},$={logic:new T,grid:D,name:"Computer"},new x,_=new z(M,$),M.container=new A(document.querySelector("#left-playing-div"),M.logic.board),$.container=new A(document.querySelector("#right-playing-div"),$.logic.board,_.isComputerPlaying()),M.grid.makeCellsAcceptDrag(),k.removeCellsListeners(),k.addListenersToCells(_.isComputerPlaying())}function F(e,t,n){if(_.isLeftTurn()!==n)try{const n=_.getNextAttacked();n.logic.board.receiveAttack(e,t)?(n.grid.reviewShip(e,t),n.logic.board.areAllSunk()&&v().publish(j,{winnerName:_.getNext().name,winnerShipNumber:_.getNext().logic.board.aliveShips})):(n.grid.reviewEmpty(e,t),_.changeTurn())}catch(e){new w(e).show(2e3)}else _.isComputerPlaying()||new w("Please select one cell of opponents grid").show(2e3)}function Z(){_.isPlaying()?new w("Game already started").show(1e3):(k.removeDragListeners(),k.clearGrid(document.querySelector("#left-playing-div")),M={logic:new q,grid:L,name:"Player"},_=new z(M,$),M.container=new A(document.querySelector("#left-playing-div"),M.logic.board,!1,!0),M.logic.placeShips(),M.logic.board.getAllShips().forEach((e=>M.grid.showShip(...e))))}function U(){_.isPlaying()?new w("Game already started").show(1e3):(M.grid.makeCellsAcceptDrag(),k.clearGrid(document.querySelector("#left-playing-div")),M={logic:new q,grid:L,name:"Player"},_=new z(M,$),M.container=new A(document.querySelector("#left-playing-div"),M.logic.board))}function G(){return M.container.getElement().childNodes.length?(new w("Place your ships to start game!").show(1500),!1):(_.startPlaying(),!0)}B(),v().subscribe(j,(function(e,t){S.create(t.winnerName,t.winnerShipNumber,(()=>B()))}))})()})();